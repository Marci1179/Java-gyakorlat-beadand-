<!DOCTYPE html>
<html lang="hu" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Diagram</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { background-color: #1a1a1a; color: white; margin: 0; }
        .f1-navbar { background-color: #111; border-bottom: 3px solid #e10600; }
        .f1-nav { list-style: none; margin: 0; padding: 10px 0; display: flex; justify-content: center; gap: 24px; }
        .f1-nav li a { color: #ddd; text-decoration: none; font-weight: 600; }
        .f1-nav li a:hover { color: #e10600; }
        header { background-color: #2b2b2b; padding: 80px 0; text-align: center; }
        h1 { font-size: 4rem; font-weight: 800; text-transform: uppercase; }

        .diagram-container {
            max-width: 900px;
            margin: 40px auto 80px auto;
            background-color: #222;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 0 25px rgba(0,0,0,0.6);
        }

        .diagram-container h2 {
            font-size: 1.6rem;
            margin-bottom: 10px;
        }

        .diagram-container p {
            color: #aaa;
            margin-bottom: 24px;
        }
    </style>
</head>

<body>

<nav class="f1-navbar">
    <ul class="f1-nav">
        <li><a th:href="@{/fooldal}">Főoldal</a></li>
        <li><a th:href="@{/adatbazis}">Adatbázis</a></li>
        <li><a th:href="@{/kapcsolat}">Kapcsolat</a></li>
        <li><a th:href="@{/diagram}">Diagram</a></li>
        <li><a th:href="@{/crud}">CRUD</a></li>
        <li><a th:href="@{/restful}">RESTful</a></li>

        <li th:if="${session.loggedInUser != null}">
            <a th:href="@{/uzenetek}">Üzenetek</a>
        </li>

        <!-- ADMIN csak adminnak -->
        <li th:if="${session.loggedInUser != null and session.loggedInUser.role == 'admin'}">
            <a th:href="@{/admin}">Admin</a>
        </li>

        <li th:if="${session.loggedInUser == null}">
            <a th:href="@{/login}">Bejelentkezés</a>
        </li>
        <li th:if="${session.loggedInUser == null}">
            <a th:href="@{/register}">Regisztráció</a>
        </li>
        <li th:if="${session.loggedInUser != null}">
            <a th:href="@{/logout}">Kijelentkezés</a>
        </li>
    </ul>
</nav>

<header>
    <h1>Diagram</h1>
</header>

<div class="diagram-container">
    <h2>Pilóták megoszlása nemzetiség szerint</h2>
    <p>
        Az alábbi oszlopdiagram a <strong>pilots</strong> tábla adatai alapján mutatja meg,
        hogy egyes nemzetiségekből hány pilóta található az adatbázisban.
    </p>

    <canvas id="pilotsChart" height="120"></canvas>
</div>

<!-- Chart.js inicializálás Thymeleaf adatokkal -->
<script th:inline="javascript">
    /*<![CDATA[*/
    const labels = /*[[${labels}]]*/ [];
    const data   = /*[[${data}]]*/ [];

    const ctx = document.getElementById('pilotsChart').getContext('2d');

    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Pilóták száma',
                data: data,
                backgroundColor: '#e10600',
                borderColor: '#e10600',
                borderWidth: 2
            }]
        },

        options: {
            responsive: true,
            plugins: {
                legend: {
                    labels: {
                        color: 'white'
                    }
                }
            },
            scales: {
                x: {
                    ticks: { color: 'white' },
                    grid: { color: 'rgba(255,255,255,0.1)' }
                },
                y: {
                    beginAtZero: true,
                    ticks: { color: 'white' },
                    grid: { color: 'rgba(255,255,255,0.1)' }
                }
            }
        }
    });
    /*]]>*/
</script>

</body>
</html>
